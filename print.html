<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Webwire</title>
        
        <meta name="robots" content="noindex" />
        
        


        <!-- Custom HTML head -->
        <meta property="og:site_name" content="Webwire - Contract-First API System">
<meta property="og:title" content="">
<meta property="og:type" content="article">
<meta property="og:image" content="https://webwire.dev/og-image.png">
<meta property="og:description" content="Webwire is a Contract-First API System which features an interface description language, bidirectional RPC and code generation for servers and clients.">
<meta name="theme-color" content="#2c89a0">
<meta name="twitter:card" content="summary_large_image">


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="Webwire is a Contract-First API System which features an interface description language, bidirectional RPC and code generation for servers and clients.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><strong aria-hidden="true">2.</strong> Getting started</li><li class="chapter-item expanded "><a href="example.html"><strong aria-hidden="true">3.</strong> Example</a></li><li class="chapter-item expanded "><a href="codegen.html"><strong aria-hidden="true">4.</strong> Code generator</a></li><li class="chapter-item expanded "><strong aria-hidden="true">5.</strong> Specification</li><li><ol class="section"><li class="chapter-item expanded "><a href="idl.html"><strong aria-hidden="true">5.1.</strong> Interface Description Language</a></li><li class="chapter-item expanded "><a href="protocol/index.html"><strong aria-hidden="true">5.2.</strong> Transport Protocol</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="protocol/websocket.html"><strong aria-hidden="true">5.2.1.</strong> Websocket</a></li><li class="chapter-item expanded "><a href="protocol/http.html"><strong aria-hidden="true">5.2.2.</strong> HTTP</a></li></ol></li></ol></li><li class="chapter-item expanded "><strong aria-hidden="true">6.</strong> Language support</li><li><ol class="section"><li class="chapter-item expanded "><strong aria-hidden="true">6.1.</strong> Rust</li><li class="chapter-item expanded "><strong aria-hidden="true">6.2.</strong> TypeScript (and JavaScript)</li><li class="chapter-item expanded "><strong aria-hidden="true">6.3.</strong> Python</li><li class="chapter-item expanded "><strong aria-hidden="true">6.4.</strong> Go</li><li class="chapter-item expanded "><strong aria-hidden="true">6.5.</strong> Dart (and Flutter)</li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">Webwire</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        <a href="https://github.com/webwire/webwire-docs" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <p><img src="./teaser.svg" alt="webwire logo" /></p>
<p><a href="https://discord.gg/jjD6aWG"><img src="https://img.shields.io/discord/726922033039933472?label=Discord+Chat&amp;color=%23677bc4&amp;logo=discord&amp;logoColor=white&amp;style=for-the-badge" alt="Discord Chat" /></a></p>
<p>Webwire is a <strong>contract-first API</strong> system which features an
<a href="/idl.html">interface description language</a>,
a network <a href="/protocol.html">protocol</a> and
<a href="/codegen.html">code generator</a> for both servers and clients.</p>
<p>This repository contains the documentation sources used to generate
the website at <a href="https://webwire.dev/">https://webwire.dev/</a>.</p>
<h2><a class="header" href="#resources" id="resources">Resources</a></h2>
<ul>
<li><strong>Website:</strong> <a href="https://webwire.dev/">https://webwire.dev/</a></li>
<li><strong>GitHub:</strong> <a href="https://github.com/webwire/">https://github.com/webwire/</a></li>
<li><strong>Discord:</strong> <a href="https://discord.gg/jjD6aWG">https://discord.gg/jjD6aWG</a></li>
</ul>
<h2><a class="header" href="#work-in-progress" id="work-in-progress">WORK IN PROGRESS</a></h2>
<blockquote>
<p><strong>Webwire is not ready to use! All the documentation and code in this
repository is either incomplete or non functional. Don't expect anything
to work, yet. Right now this repository is just a collection of ideas and
preliminary implementations.</strong></p>
</blockquote>
<h2><a class="header" href="#building-blocks" id="building-blocks">Building blocks</a></h2>
<ul>
<li>
<p>The <a href="/idl.html">webwire interface description language</a>
describes service endpoints and how they are called.</p>
</li>
<li>
<p>The <a href="/protocol.html">webwire protocol</a> is the actual representation
how data is transferred between client and server.</p>
</li>
<li>
<p>The <a href="/codegen.html">webwire code generator</a> uses the schema
language to generate client and server stubs.</p>
</li>
<li>
<p>The <strong>webwire library</strong> is language specific and is used together
with the code generated by the <a href="/codegen.html">webwire code generator</a>
to write servers and clients using that interface.</p>
</li>
</ul>
<h2><a class="header" href="#unique-selling-points" id="unique-selling-points">Unique selling points</a></h2>
<ul>
<li>
<p>Webwire generates client and server code which is ready to run. The
generated code contains everything to make requests and implement
services.</p>
</li>
<li>
<p>Webwire supports both <strong>stateless unidirectional</strong> communication and and
<strong>stateful bidirectional</strong> communication. This makes it a perfect fit for
application that require some kind of real-time update from the server
without the client having to poll for updates.</p>
</li>
<li>
<p>Webwire validates requests and responses. If data does not match the
given schema an error is raised an the data is not processed any
further.</p>
</li>
<li>
<p>Webwire is modelled after programming languages and not after a
serialization format. Therefore types like <code>UUID</code>, <code>Date</code> and <code>Time</code>
are part of the specification even if the used serialization format
does not support them. When using a serialization format which does
not support those types natively (e.g. JSON) they are encoded as
string. This is transparent to the user of webwire.</p>
</li>
<li>
<p>Webwire has a special type called <code>fieldset</code>. Fieldsets can be used to
construct a struct out of another struct by picking a subset of fields.
This is especially useful when designing APIs where multiple endpoints
use almost the same structure which just differs in a few fields.</p>
</li>
</ul>
<h2><a class="header" href="#non-goals" id="non-goals">Non goals</a></h2>
<ul>
<li>Webwire can not be used to describe existing APIs. Webwire only makes
sense as a whole package. The IDL, protocol, code generator and
libraries all make a complete package and leaving out one or the other
just doesn't make any sense. If you need to document an existing API
have a look at
<a href="https://swagger.io/docs/specification/about/">OpenAPI</a>.</li>
</ul>
<h2><a class="header" href="#example" id="example">Example</a></h2>
<p>The following example assumes a Rust server and a TypeScript client. Webwire
is by no means limited to those two but those languages show the potential of
webwire best.</p>
<p>Given the following IDL file:</p>
<pre><code class="language-webwire">webwire 1.0;

struct HelloRequest {
    name: String,
}

struct HelloResponse {
    message: String,
}

service Hello {
    hello: HelloRequest -&gt; HelloResponse
}
</code></pre>
<p>The server and client files can be generated using the code generator:</p>
<pre><code class="language-shell">$ webwire generate rust server api/hello.ww server/src/api.rs
$ webwire generate ts client api/hello.ww client/src/api.ts
</code></pre>
<p>A Rust server implementation for the given code would look like this:</p>
<pre><pre class="playground"><code class="language-rust">use std::net::SocketAddr;
use webwire::{Context, Request, Response}
use webwire::hyper::Server;

mod api;
use api::v1::{Hello, HelloRequest, HelloResponse}; // this is the generated code

struct HelloService {}

impl Hello for HelloService {
    fn hello(&amp;self, ctx: &amp;Context, request: &amp;HelloRequest) -&gt; HelloResponse {
        HelloResponse {
            message: format!(&quot;Hello {}!&quot;, request.name)
        }
    }
}

#[tokio::main]
async fn main() -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt; {
    let addr = SocketAddr::from(([127, 0, 0, 1], 8000));
    let service = HelloService {};
    let server = webwire::Server::bind(addr).serve(service);
    server.await
}
</code></pre></pre>
<p>A TypeScript client using the generated code would look like that:</p>
<pre><code class="language-js">import { Client } from 'api/v1' // this is the generated code

client = new Client('http://localhost:8000/')
const response = await client.hello({ name: 'World' })
assert(response.message === 'Hello World!')
</code></pre>
<h1><a class="header" href="#code-generator" id="code-generator">Code generator</a></h1>
<h2><a class="header" href="#todo" id="todo">TODO</a></h2>
<h1><a class="header" href="#interface-description-language" id="interface-description-language">Interface Description Language</a></h1>
<p>The interface description language of webwire is inspired by the
<a href="https://www.rust-lang.org/">Rust</a> programming language.</p>
<p>The syntax is specified using <a href="https://en.wikipedia.org/wiki/Extended_Backus%E2%80%93Naur_Form">Extended Backus-Naur Form
(EBNF)</a>:</p>
<pre><code>|   alternation
()  grouping
[]  option (zero or one time)
{}  repetition (any number of times)
</code></pre>
<h2><a class="header" href="#lexical-elements" id="lexical-elements">Lexical elements</a></h2>
<pre><code>LETTER = &quot;A&quot; … &quot;Z&quot; | &quot;a&quot; ... &quot;z&quot;
DIGIT_DEC = &quot;0&quot; … &quot;9&quot;
DIGIT_HEX = DIGIT_DEC | &quot;A&quot; … &quot;F&quot; | &quot;a&quot; … &quot;f&quot;
</code></pre>
<h2><a class="header" href="#identifier" id="identifier">Identifier</a></h2>
<p>Identifiers must start with a letter. Subsequent characters may also
include digits and the underscore <code>&quot;_&quot;</code> character.</p>
<pre><code>identifier = LETTER { LETTER | DIGIT_DEC | &quot;_&quot; }
</code></pre>
<h2><a class="header" href="#values" id="values">Values</a></h2>
<h3><a class="header" href="#boolean" id="boolean">Boolean</a></h3>
<p>Booleans are either <code>true</code> or <code>false</code>.</p>
<pre><code>boolean = &quot;true&quot; | &quot;false&quot;
</code></pre>
<h3><a class="header" href="#integer" id="integer">Integer</a></h3>
<p>Integers support both decimal and hexadecimal format.</p>
<pre><code>integer_dec = [ &quot;+&quot; | &quot;-&quot; ] DIGIT_DEC { DIGIT_DEC }
integer_hex = [ &quot;+&quot; | &quot;-&quot; ] &quot;0&quot; (&quot;X&quot; | &quot;x&quot;) DIGIT_HEX { DIGIT_HEX }
integer = integer_dec | integer_hex
</code></pre>
<p>Examples:</p>
<ul>
<li><code>57005</code></li>
<li><code>+3</code></li>
<li><code>-5</code></li>
<li><code>0x539</code></li>
<li><code>+0xFF</code></li>
<li><code>-0x7FFF</code></li>
</ul>
<h3><a class="header" href="#float" id="float">Float</a></h3>
<p>Floats must contain at least one digit before and after the decimal separator.</p>
<pre><code>float = [ &quot;+&quot; | &quot;-&quot; ] DIGIT_DEC { DIGIT_DEC } &quot;.&quot; DIGIT_DEC { DIGIT_DEC }
</code></pre>
<p>Examples:</p>
<ul>
<li><code>2.56</code></li>
<li><code>+5.3338</code></li>
<li><code>-0.5</code></li>
</ul>
<h3><a class="header" href="#string" id="string">String</a></h3>
<p>Strings are quoted using double quotes <code>'&quot;'</code> and the backspace character <code>&quot;\&quot;</code>
is used to escape special characters.</p>
<p>Supported escapes are:</p>
<ul>
<li><code>\\</code> → backspace <code>&quot;\&quot;</code></li>
<li><code>\&quot;</code> → double quote <code>'&quot;'</code></li>
<li><code>\n</code> → newline (linefeed)</li>
</ul>
<pre><code>string = '&quot;' { char_escape | /[^\\]/ } '&quot;'
char_escape = &quot;\&quot; ( &quot;\&quot; | '&quot;' | &quot;n&quot; )
</code></pre>
<p>Examples:</p>
<ul>
<li><code>&quot;master&quot;</code></li>
<li><code>&quot;line1\nline2\nline3&quot;</code></li>
<li><code>&quot;backslash: \\&quot;</code></li>
</ul>
<h3><a class="header" href="#range" id="range">Range</a></h3>
<p>Ranges have an upper and lower bound which are separated via <code>&quot;..&quot;</code></p>
<pre><code>range = integer &quot;..&quot; integer
</code></pre>
<p>Examples:</p>
<ul>
<li><code>0..255</code></li>
<li><code>0..0xFF</code></li>
<li><code>1..</code></li>
<li><code>..50</code></li>
</ul>
<h2><a class="header" href="#types" id="types">Types</a></h2>
<p>Types can either be named or used as part of an array type or map type. The
named form also supports passing generic parameters.</p>
<pre><code>type = (type_named | type_array | type_map) [ type_options ]
type_named = identifier [&quot;&lt;&quot; type { &quot;,&quot; type } &quot;&gt;&quot;]
type_array = &quot;[&quot; type &quot;]&quot;
type_map = &quot;{&quot; type &quot;:&quot; type &quot;}&quot;
type_options = &quot;(&quot; [ type_option { &quot;,&quot; type_option } [ &quot;,&quot; ] ] &quot;)&quot;
type_option = identifier &quot;=&quot; value
</code></pre>
<p>Examples:</p>
<ul>
<li><code>FooBar</code></li>
<li><code>PaginatedResponse&lt;Bar&gt;</code></li>
<li><code>[ Integer ]</code></li>
<li><code>[ Integer ] (length=1..16)</code></li>
<li><code>{ Integer: String }</code></li>
<li><code>String (length=0..50)</code></li>
<li><code>Integer (range=-0x80..0x7F)</code></li>
</ul>
<h3><a class="header" href="#builtin-types" id="builtin-types">Builtin types</a></h3>
<p>Builtin types are reserved type names and can not be used as names for your
own types. It is however possible to use them as identifiers though this
SHOULD NOT be done on a regular basis.</p>
<p>Builtin types are:</p>
<ul>
<li><code>Boolean</code></li>
<li><code>Integer</code></li>
<li><code>Float</code></li>
<li><code>String</code></li>
<li><code>Date</code></li>
<li><code>Time</code></li>
<li><code>DateTime</code></li>
<li><code>UUID</code></li>
<li><code>None</code></li>
<li><code>Nullable&lt;T&gt;</code></li>
<li><code>Result&lt;T, E&gt;</code></li>
</ul>
<p><code>None</code> is a special type that does only have one valid value which
is <code>None</code>. This is useful for methods that don't have input or output
types and when working with optional generics. <code>None</code> should not be
used on its own for field types as it has no meaning there.</p>
<p><code>Nullable</code> is a special type which wraps another type internally.
It is similar to <code>enum Nullable&lt;T&gt; { Some(T), Null }</code> except that it
maps to <code>null</code> or a similar values in programming languages that
support this concept. It is typically used in APIs to clear values.
This must not be confused with
<a href="idl.html#Optional_fields_and_nullable_types">optional fields</a> of structures.</p>
<p><code>Result</code> is a special type which is an enum that can either be <code>Ok(T)</code>
or <code>Err(E)</code>. It is similar to <code>enum Result&lt;T, E&gt; { Ok(T), Err(E) }</code>
except that it maps directly to the builtin <code>Result</code> type if supported
by the target programming language.</p>
<h2><a class="header" href="#generics" id="generics">Generics</a></h2>
<p>Structures, Enumerations and some builtin types support generics.</p>
<pre><code>generics = &quot;&lt;&quot; identifier { &quot;,&quot; identifier } &quot;&gt;&quot;
</code></pre>
<h2><a class="header" href="#struct" id="struct">Struct</a></h2>
<p>Structures are a collection of fields of storing complex data
structures.</p>
<pre><code>struct = &quot;struct&quot; identifier [ generics ] &quot;{&quot; [ struct_fields ] &quot;}&quot;
struct_fields = struct_field &quot;,&quot; struct_field
struct_field = identifier [ &quot;?&quot; ] &quot;:&quot; type
</code></pre>
<p>Examples:</p>
<ul>
<li>
<pre><code>struct Pet {
    name: String,
    age?: Integer
}
</code></pre>
</li>
<li>
<pre><code>struct Complex {
    r: Float,
    i: Float
}
</code></pre>
</li>
<li>
<pre><code>struct Person {
    first_name: String (length=1..50)
}`
</code></pre>
</li>
<li>
<pre><code>struct PaginatedResponse&lt;T&gt; {
    results: T,
    page: Integer(range=0..),
    count: Integer(range=0..),
}
</code></pre>
</li>
</ul>
<h3><a class="header" href="#optional-fields-and-nullable-types" id="optional-fields-and-nullable-types">Optional fields and nullable types</a></h3>
<p>By appending a <code>?</code> to the field identifier a field is marked as
optional. Optional means that the field can be absent from the structure.</p>
<p>There also exists the special <code>Nullable&lt;T&gt;</code> type which is used for
something completely different. While optional means that the field
can be missing from the serialized structure <code>Nullable&lt;T&gt;</code> means that
instead of <code>T</code> a special <code>Null</code> value can be transferred instead.
It is perfectly valid to use  optional and nullable at the same time:</p>
<pre><code>struct UpdateProfile {
    name?: String,
    age?: Nullable&lt;Integer&gt;,
}
</code></pre>
<p>Both <code>name</code> and <code>age</code> are optional in this example. Since Strings do
have a special empty value (the empty string: &quot;&quot;) it does not need
to be <code>Nullable</code>. Integers on the other hand do not have such thing
so <code>Nullable&lt;Integer&gt;</code> would make it possilbe to clear the age of a
user profile. A JSON serialized structure containing an empty string
for the <code>name</code> and <code>Null</code> for the <code>age</code> would look like this:</p>
<pre><code class="language-json">{
    &quot;name&quot;: &quot;&quot;,
    &quot;age&quot;: null,
}
</code></pre>
<p>Some programming languages and serialization formats support this quite
naturaly. JavaScript and JSON differenciate between <code>undefined</code> and <code>null</code>
for object attributes. For languages that don't support this out of the
box optional fields and nullable types are put in a special wrapper.</p>
<h2><a class="header" href="#fieldset" id="fieldset">Fieldset</a></h2>
<p>Fieldset is a special kind of structure that does not define
its own fields but uses an existing structure and creates a subset
of it. This feature is mainly for keeping the repetition for
typical CRUD APIs as little as possible.</p>
<pre><code>fieldset = &quot;fieldset&quot; identifier &quot;for&quot; identifier &quot;{&quot; struct_fields &quot;}&quot;
fieldset_fields = [ fieldset_field { &quot;,&quot; fieldset_field } [ &quot;,&quot; ] ]
fieldset_field = identifier [ &quot;?&quot; ]
</code></pre>
<p>Examples:</p>
<ul>
<li>
<pre><code>fieldset PersonUpdate for Person {
    id,
    first_name?,
    last_name?
}
</code></pre>
</li>
</ul>
<h2><a class="header" href="#enumerations" id="enumerations">Enumerations</a></h2>
<p>Enumerations in <code>webwire</code> fulfill two things. They can either be
used as plain enumerations like in most programming languages. An
optional type argument makes it possible to describe tagged unions.</p>
<p>This is especially handly for returning errors which might contain
data which depends on the actual error code.</p>
<p>Enumerations can also extend existing enumerations.</p>
<pre><code>enum = &quot;enum&quot; identifier [ generics ] [ enum_extends ] &quot;{&quot; enum_variants &quot;}&quot;
enum_extends = &quot;extends&quot; identifier [ generics ]
enum_variants = [ enum_variant { &quot;,&quot; enum_variant } [ &quot;,&quot; ] ]
enum_variant = identifier [ &quot;(&quot; type &quot;)&quot; ]
</code></pre>
<p>Examples:</p>
<ul>
<li>
<pre><code>enum Status {
    Enabled,
    Disabled,
    Error
}
</code></pre>
</li>
<li>
<pre><code>enum AuthError {
    Unauthenticated,
    PermissionDenied
}
</code></pre>
</li>
<li>
<pre><code>enum GetError extends AuthError {
    DoesNotExist
}
</code></pre>
</li>
<li>
<pre><code>enum Notification {
    UserJoined(User),
    UserLeft(User),
    Message(ChatMessage),
}
</code></pre>
</li>
</ul>
<h2><a class="header" href="#namespace" id="namespace">Namespace</a></h2>
<p>TODO</p>
<pre><code>namespace = &quot;namespace&quot; identifier &quot;{&quot; namespace_parts &quot;}&quot;
namespace_parts = { namespace_part }
namespace_part = struct | fieldset | enum | namespace | service
</code></pre>
<h2><a class="header" href="#service" id="service">Service</a></h2>
<p>TODO</p>
<pre><code>service = [&quot;async&quot; | &quot;sync&quot;] &quot;service&quot; identifier &quot;{&quot; methods &quot;}&quot;
methods = [ method { &quot;,&quot; method } [ &quot;,&quot; ] ]
method = identifier &quot;:&quot; ( type | &quot;None&quot; ) &quot;-&gt;&quot; ( type | &quot;None&quot; )
</code></pre>
<h1><a class="header" href="#transport-protocol" id="transport-protocol">Transport Protocol</a></h1>
<p>The webwire transport protocol exists in two variants.</p>
<ol>
<li>Stateless unidirectional (e.g. HTTP)</li>
<li>Stateful bidirectional (e.g. WebSocket connections)</li>
</ol>
<p>Both variants share some common terms and definitions which are
explained on this page.</p>
<h2><a class="header" href="#framing" id="framing">Framing</a></h2>
<p>It is assumed that all protocols being used to transfer webwire messages
already implement framing. Thus the webwire protocol does not encode its
own frame length but leaves that to the underlying protocol.</p>
<p>If the underlying protocol does not implement framing a framing layer
must be implemented first. This is to be defined in the transport layer
specific documentation.</p>
<h2><a class="header" href="#fully-qualified-method-names-fqmn" id="fully-qualified-method-names-fqmn">Fully qualified method names (FQMN)</a></h2>
<p>Fully qualified method names are dot (<code>.</code>) separated identifiers. All
identifiers must be ASCII only, start with a letter followed by any number
of alphanumeric characters. The last two parts are called the service name
and the method name. Any leading part is called the namespace.</p>
<p>Examples:</p>
<table><thead><tr><th>FQMN</th><th>Namespace</th><th>Service</th><th>Method</th></tr></thead><tbody>
<tr><td><code>Example.hello</code></td><td>-</td><td>Example</td><td>hello</td></tr>
<tr><td><code>foo.Example.hello</code></td><td>foo</td><td>Example</td><td>hello</td></tr>
<tr><td><code>foo.bar.Example.hello</code></td><td>foo.bar</td><td>Example</td><td>hello</td></tr>
</tbody></table>
<p>Invalid examples:</p>
<table><thead><tr><th>FQMN</th><th>Why is it invalid?</th></tr></thead><tbody>
<tr><td><code>hello</code></td><td>Only one part. Service and method name are mandatory</td></tr>
<tr><td><code>hey.123test</code></td><td>The method name must not start with a number</td></tr>
<tr><td><code>123hey.test</code></td><td>The service name must not start with a number</td></tr>
<tr><td><code>123ns.hey.test</code></td><td>The namespace must not start with a number</td></tr>
<tr><td><code>Über.awesome</code></td><td>Non ASCII character</td></tr>
</tbody></table>
<h2><a class="header" href="#error-codes" id="error-codes">Error codes</a></h2>
<table><thead><tr><th>Code</th><th>Description</th></tr></thead><tbody>
<tr><td>ServiceNotFound</td><td>The requested service does not exist.</td></tr>
<tr><td>MethodNotFound</td><td>The requested method does not exist.</td></tr>
<tr><td>ValidationError</td><td>The data could not be deserialized and validated.</td></tr>
<tr><td>InternalError</td><td>Something bad happened while processing the request.</td></tr>
</tbody></table>
<h1><a class="header" href="#websocket-protocol" id="websocket-protocol">Websocket protocol</a></h1>
<p>All messages are encoded as a space separated list. The first part of a
message is always a numeric message type followed by message specific fields.</p>
<h2><a class="header" href="#message-id" id="message-id">Message id</a></h2>
<p>Most messages require a <code>message_id</code> to be sent. Both server and client
must implement it as a counter without gaps starting at 1. It is used to
match match request and response messages together and provide
reliable messaging even in case of a unexpected connection timeout.</p>
<h2><a class="header" href="#message-types" id="message-types">Message types</a></h2>
<p>The following message types are supported:</p>
<table><thead><tr><th>Code</th><th>Message type</th></tr></thead><tbody>
<tr><td>0</td><td>Heartbeat</td></tr>
<tr><td>1</td><td>Notification</td></tr>
<tr><td>2</td><td>Request</td></tr>
<tr><td>3</td><td>Response</td></tr>
<tr><td>4</td><td>Error response</td></tr>
<tr><td>-1</td><td>Disconnect</td></tr>
</tbody></table>
<h3><a class="header" href="#heartbeat" id="heartbeat">Heartbeat</a></h3>
<p>The heartbeat is used by the client and server to acknowledge messages
and keep the connection alive if there has been no traffic for a given
amount of time. For transports that do not keep the connection open for
an unlimited amount of time this is used for polling.</p>
<table><thead><tr><th>Field</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>message_type</code></td><td>Integer</td><td>Constant <code>0</code></td></tr>
<tr><td><code>last_message_id</code></td><td>Integer</td><td>The last message id of the remote side that has been received.</td></tr>
</tbody></table>
<p>Example:</p>
<pre><code>0 42
</code></pre>
<h3><a class="header" href="#notification" id="notification">Notification</a></h3>
<p>Send a notification to the remote side and do not expect a response. This
message type is especially useful to implement broadcasts from the server
to the client where no response is expected. Implementations of webwire
MUST NOT expect a response to a notification.</p>
<p>Fields:</p>
<table><thead><tr><th>Field</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>message_type</code></td><td>Integer</td><td>Constant <code>1</code></td></tr>
<tr><td><code>message_id</code></td><td>Integer</td><td>The <code>id</code> of the message.</td></tr>
<tr><td><code>method</code></td><td>FQMN</td><td>The fully qualified method name of the method to be called.</td></tr>
<tr><td><code>data</code></td><td>Binary</td><td>The data field captures the rest of the frame and is treated as binary.</td></tr>
</tbody></table>
<p>Example:</p>
<pre><code>1 43 example.hello peter
</code></pre>
<h3><a class="header" href="#request" id="request">Request</a></h3>
<p>Send a request to the remote side and expect a response.</p>
<table><thead><tr><th>Field</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>message_type</code></td><td>Integer</td><td>Constant <code>2</code></td></tr>
<tr><td><code>message_id</code></td><td>Integer</td><td>The <code>id</code> of the message.</td></tr>
<tr><td><code>method</code></td><td>FQMN</td><td>The fully qualified method name of the method to be called.</td></tr>
<tr><td><code>data</code></td><td>Binary</td><td>The data field captures the rest of the frame and is treated as binary.</td></tr>
</tbody></table>
<p>Example:</p>
<pre><code>2 44 example.get_version
</code></pre>
<h3><a class="header" href="#response" id="response">Response</a></h3>
<p>This message is sent in response to a request if the remote method could be called
successfully.</p>
<table><thead><tr><th>Field</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>message_type</code></td><td>Integer</td><td>Constant <code>3</code></td></tr>
<tr><td><code>message_id</code></td><td>Integer</td><td>The <code>id</code> of the message.</td></tr>
<tr><td><code>request_message_id</code></td><td>Integer</td><td>The <code>id</code> of the message that started the request.</td></tr>
<tr><td><code>data</code></td><td>Binary</td><td>The data field captures the rest of the frame and is treated as binary.</td></tr>
</tbody></table>
<p>Example:</p>
<pre><code>3 7 44 &quot;1.4.9&quot;
</code></pre>
<h3><a class="header" href="#error-response" id="error-response">Error response</a></h3>
<p>This message is sent in response to a request if the remote side encountered
an error while processing the request. Please note that this message type
MUST NOT be used to encode application level errors. This is only meant to be
used for errors which are outside of the application scope. e.g. parser errors,
data validation, internal server errors, etc.</p>
<table><thead><tr><th>Field</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>message_type</code></td><td>Integer</td><td>Constant <code>4</code></td></tr>
<tr><td><code>message_id</code></td><td>Integer</td><td>The <code>id</code> of the message.</td></tr>
<tr><td><code>request_message_id</code></td><td>Integer</td><td>The <code>id</code> of the message that started the request.</td></tr>
<tr><td><code>error_code</code></td><td>Binary</td><td>The data field captures the rest of the frame and is treated as binary.</td></tr>
<tr><td><code>error_message</code></td><td>String</td><td>Optional error message.</td></tr>
</tbody></table>
<p>Example:</p>
<pre><code>4 7 44 MethodNotFound
</code></pre>
<h3><a class="header" href="#disconnect" id="disconnect">Disconnect</a></h3>
<p>Terminate the current connection. The remote side should respond with a <code>-1</code>
and close the connection.</p>
<table><thead><tr><th>Field</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>message_type</code></td><td>Integer</td><td>Constant <code>-1</code></td></tr>
</tbody></table>
<p>Example:</p>
<pre><code>-1
</code></pre>
<h2><a class="header" href="#example-communication" id="example-communication">Example communication</a></h2>
<p>Assuming the connection has been up for a while and the server has now
reached message id 117. The client has sent 5 messages so far and the
next message id is 5.</p>
<ol>
<li>
<p>Heartbeat (client to server):</p>
<pre><code>0 117
</code></pre>
</li>
<li>
<p>Heartbeat (server to client):</p>
<pre><code>0 4
</code></pre>
</li>
<li>
<p>Notification (client to server):</p>
<pre><code>1 5 Player.ready true
</code></pre>
</li>
<li>
<p>Request (client to server):</p>
<pre><code>2 6 get_time
</code></pre>
</li>
<li>
<p>Response (server to client):</p>
<pre><code>3 118 6 1342106240
</code></pre>
</li>
</ol>
<h1><a class="header" href="#http" id="http">HTTP</a></h1>
<h2><a class="header" href="#path" id="path">Path</a></h2>
<p>Requests and notifications are sent relative to a given <code>base_url</code> with
the fully qualified method name appended:</p>
<p>Example:</p>
<pre><code>base_url: /ww
fqmn: Example.hello

path: /ww/Example.hello
</code></pre>
<h2><a class="header" href="#headers" id="headers">Headers</a></h2>
<p>The following headers are respected by webwire:</p>
<table><thead><tr><th>Header</th><th>Description</th></tr></thead><tbody>
<tr><td>X-Webwire</td><td>This must be either <code>Notification</code> or <code>Request</code></td></tr>
</tbody></table>
<h2><a class="header" href="#notification-1" id="notification-1">Notification</a></h2>
<p>The server is expected to answer with <code>204 OK</code> or <code>400 Bad Request</code>.
In case of an internal server error the status code <code>500 Internal Server Error</code> is identical to a 400 Request with the <code>InternalError</code>
payload.</p>
<p>HTTP request:</p>
<pre><code>POST /ww/example HTTP/1.1
Host: example-api.webwire.dev
Authorization: Basic QWxhZGRpbjpvcGVuIHNlc2FtZQ==
X-Webwire: Notification

&quot;world&quot;
</code></pre>
<p>HTTP response - Ok:</p>
<pre><code>HTTP/1.1 204
</code></pre>
<p>HTTP response - Error:</p>
<pre><code>HTTP/1.1 400

&quot;MethodNotFound&quot;
</code></pre>
<h2><a class="header" href="#request-1" id="request-1">Request</a></h2>
<p>The server is expected to answer with <code>200 OK</code> or <code>400 Bad Request</code>.</p>
<p>HTTP request:</p>
<pre><code>POST /ww/Example.get_version? HTTP/1.1
Authorization: Basic QWxhZGRpbjpvcGVuIHNlc2FtZQ==
X-Webwire: Request
</code></pre>
<p>HTTP response - Ok:</p>
<pre><code>HTTP/1.1 200 OK

&quot;1.12.3&quot;
</code></pre>
<p>HTTP response - Error:</p>
<pre><code>HTTP/1.1 400

&quot;ValidationError&quot;
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        

                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                

                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        
        
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
        
        

    </body>
</html>
